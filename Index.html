<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <h1><a
            href="https://api.instagram.com/oauth/authorize?client_id=436614004251305&redirect_uri=https://distracted-dijkstra-43434d.netlify.app/&scope=user_profile,user_media&response_type=code">Klik
            hier om te verbinden met de instagram api</a>
    </h1>
    <p id='name'>Name: </p>
    <p id='id'>Id: </p>
    <div id=" instafeed"></div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script>
        $.ajax({
            url: 'https://graph.instagram.com/949628393?fields=id,username&access_token=IGQVJYYW5DczZAuSzB6U2V0ZA1ExTmZAjd1V2VC1SZADhYOS0wckpHNmZAXWURvSTVVTkZA3UEFNLUlYSEl4SS1tM2gtM3pnR0VacnREZA0xfRXFNdmliWTgzNmIxRUlyRHE1bUxFYkJ4cEpMa0UzQ2dnanM1UQZDZD',

            error: function (data) {
                console.log('error')
                console.log(data)
            },

            success: function (data) {

            },
            type: 'GET',
            dataType: "jsonp"
        });


        const url = window.location.search;
        const urlparameter = new URLSearchParams(url)


        if (urlparameter.has('code')) {
            const urlcode = urlparameter.get('code')
            console.log(urlcode)
            $.ajax({
                url: 'https://api.instagram.com/oauth/access_token',
                type: 'POST',
                dataType: 'json',
                contentType: 'application/x-www-form-urlencoded',
                data: { client_id: '436614004251305', client_secret: '3590d7041e33e6a62b83f76c93d9892d', grant_type: 'authorization_code', redirect_uri: "https://distracted-dijkstra-43434d.netlify.app/", code: urlcode },
                success: (data) => {
                    console.log(data.access_token)
                    console.log('https://graph.instagram.com/17841405793187218?fields=id,username&access_token=' + data.access_token)
                    $.ajax({
                        url: 'https://graph.instagram.com/me?fields=id,username&access_token=' + data.access_token,
                        type: 'GET',
                        dataType: "jsonp",
                        success: function (data) {
                            console.log(data)
                            $('#name').text('Name: ' + data.username)
                            $('#id').text('Id: ' + data.id)
                        },
                        error: function (data) {
                            console.log('error')
                            console.log(data)
                        },

                    });
                },
                error: (data) => { console.log(data) }

            })

        }
    </script>
</body>

</html>
<!-- 
https://api.instagram.com/oauth/access_token/?client_id=436614004251305&client_secret=3590d7041e33e6a62b83f76c93d9892d&grant_type=autorization_code&redirect_uri=https://distracted-dijkstra-43434d.netlify.app/&code= -->